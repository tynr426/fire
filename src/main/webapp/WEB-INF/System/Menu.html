<!DOCTYPE html>
<html>
<head>
<title>系统菜单</title>
<link rel="SHORTCUT ICON" href="/favicon.ico" type="image/x-icon" />
<link rel="canonical" href="/" />

<!--框架样式-->
<link rel="stylesheet" type="text/css" href="../css/index.css" />
<!--框架皮肤-->
<link rel="stylesheet" type="text/css"
	href="../css/skin/Default/skin.css" />


<!--弹出层样式-->
<link type="text/css" rel="stylesheet" href="../css/jquery-ui.css" />
<link type="text/css" rel="stylesheet"
	href="../Static/dialog/Metro/Dialog.css" />
<script language="javascript" type="text/javascript"
	src="../Static/Js/jquery-1.8.2.js?v=2.0.14.715">
</script>
<script language="javascript" type="text/javascript"
	src="../Static/Js/jquery.tmpl.js">
</script>
<script type="text/javascript" src="../js/basevalue.js">
</script>
<script type="text/javascript" src="../js/cookie_util.js">
</script>
</script>
<script type="text/javascript" src="../js/frameUI.js">
</script>
<script type="text/javascript" src="../js/system.js">
</script>
<script type="text/javascript" src="../Static/Js/jquery-ui.js">
</script>
<script type="text/javascript" src="../Static/Js/page.js">
</script>
<script type="text/javascript" src="../Static/Js/Public.js">
</script>
<script type="text/javascript" src="../js/data.json">
</script>
</head>
<body>


	<!--内容-->
	<div class="content-area">
		<!--面包屑-->
		<div class="content-title">系统菜单</div>
		<!--//面包屑-->
		<!--内容盒-->
		<div class="custom-area" id="scroll-box">
			<!--内盒-->
			<div class="custom-box" scrollarea="box">
				<!--滚动用盒层-->
				<div class="custom-scroll" scrollroom="box" lazyscroll="box">
					<div class="label-box" label-box="group1">
						<div class="mt" label-btncom="group1">
							<ul id="GroupList">
								
								 


							</ul>
						</div>

						<div class="mc" label-limitarea="group1">
							<div class="for select" label-area="group1|key1">
								<div class="extend-button">


									<div class="button">
										<a href="javascript:void(0);"
											onclick="frm.add({title: '添加顶级', formId: 'UpdateFormTemplate',callback:menu.addMenu,width:600,finish:menu.addFinish});"
											class="btn">添加顶级</a> <a href="javascript:void(0);"
											onclick='menu.updateRealMenuIds();'
											class="btn">菜单顺序同步</a>
									</div>


								</div>
							</div>
						</div>
					</div>

					<!--表格组件-->
					<div class="custom-table">
						<!--表格内盒-->
						<div class="form" id="customChangeTable">
							<table border="0" cellspacing="0" cellpadding="0"
								id="EGrid1_body">
								<colgroup>
									<col style="width: 200px;" />
									<col style="width: auto;" />
									<col style="width: 100px;" />
									<col style="width: 100px;" />
									<col style="width: 100px;" />
									<col style="width: 61px;" />
									<col style="width: 61px;" />
								</colgroup>

								<thead>
									<tr>
										<td><p class="name center">菜单名称</p></td>
										<td><p class="name center">菜单链接</p></td>
										<td><p class="name center">经营模式</p></td>
										<td><p class="name center">菜单编号</p></td>

										<td><p class="name center">显示顺序</p></td>
										<td><p class="name center">状态</p></td>
										<td><p class="name center">操作</p></td>
									</tr>
								</thead>

								<tbody id="MenuList"></tbody>
							</table>
						</div>
						<!--//表格内盒-->
						<!--通用分页-->
						<div class="page" id="PageBarList"></div>
						<!--//通用分页-->
					</div>
					<!--//表格组件-->
				</div>
				<!--//滚动用盒层-->
			</div>
			<!--//内盒-->
		</div>
		<!--//内容盒-->
	</div>
	<!--//内容-->


</body>
</html>



<script type="text/x-jquery-tmpl" id="ListTemplate">
    <tr class="child-${layer-1 } {{if list.length>0}} close {{else}}nochild{{/if}}"  treeindex="${index}" parentindex="${parentIndex}" {{if parentId!=0}} style='display:none;' {{else}}{{/if}}>
        <td>
            <div class="extend">

                <div class="grid_cell"><i class="icon" onclick="treeGrid.toggle(this);"></i><p onclick="treeGrid.toggle(this);">${menuName}</p></div>
            </div>
        </td>
        <td><div class="number">${link}</div></td>
        <td><div class="number center">${config.parseDesc(fkway)}</div></td>
        <td><div class="number center">${realMenuId}</div></td>
        <td><div class="number center">${reorder}</div></td>
        <td>
            <!--自定义开关-->
            {{if status==0}}
            <div class="extend">
                <div class="target target-off">
                    <span onclick="javascript:frm.switchStatus(this, '${id}', '${status}', function () { var li = $(this).parent('li'); if (li.hasClass('close')) { li.removeClass('close'); } else { li.addClass('close'); } },'/menu/switchStatus.do');"></span>
                </div>
            </div>
            {{else}}
            <div class="extend">
                <div class="target target-on">
                    <span onclick="javascript:frm.switchStatus(this, '${id}', '${status}', function () { var li = $(this).parent('li'); if (li.hasClass('close')) { li.removeClass('close'); } else { li.addClass('close'); } },'/menu/switchStatus.do');"></span>
                </div>
            </div>
            {{/if}}
            <!--//自定义开关-->
        </td>
        <td>
            <div class="tool" onmouseover="tableTool.over(this);" onmouseout="tableTool.out(this);">
                <!--标题栏-->
                <p class="name">操作</p>
                <!--//标题栏-->

                <div class="tool-menu">
                    <ul>
                        {{if layer< 3}}
                        <li>
                            <a href="javascript:void(0);" onclick="frm.add({title: '添加子级', formId: 'UpdateFormTemplate',callback:menu.addMenu,width:600,finish:menu.addFinish,finishArgs:['${menuName}','${realMenuId}','${layer}'] });" class="btn">添加子级</a>

                        </li>
                        <li>
                            <a href="javascript:void(0);" onclick="javascript:frm.add({title:'移动子级',formId:'MoveFormTemplate',callback:menu.move,finish:menu.moveCompleted,finishArgs:['${id}','${realMenuId}','${layer}','${menuName}','0','${parentId}']});">移动子级</a>
                        </li>
                        {{/if}}
                        <li>
                            <a href="javascript:void(0);" onclick="javascript:frm.update({title:'修改菜单',formId:'UpdateFormTemplate',id:${id},url:'/menu/getMenu.do',callback:menu.updateMenu,width:600,finish:menu.addFinish});">修改</a>
                        </li>
                        {{if (layer>1)}}
                        <li>
                            <a href="javascript:void(0);" onclick="javascript:frm.add({title:'移动',formId:'MoveFormTemplate',callback:menu.move,finish:menu.moveCompleted,finishArgs:['${id}','${realMenuId}','${layer-1}','${menuName}','1','${parentId}']});">移动</a>
                        </li>
                       
                        {{/if}}
                        <li>
                            <a href="javascript:void(0);" onclick="javascript:frm.del(${id},menu.loadMenu,'/menu/delete.do',[${roleId},$('#GroupList li[class=select]')]);">删除</a>
                        </li>
                    </ul>
                </div>
            </div>
        </td>
    </tr>
</script>

<script type="text/template" id="UpdateFormTemplate">
    <div class="custom-table" id="FormTemplate">
        <div class="form">
            <table border="0" cellpadding="0" cellspacing="0">
                <colgroup>
                    <col style="width: 150px;" />
                    <col style="width:auto;" />
                </colgroup>

                <tbody>
                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>应用程序：
                            </p>
                        </th>
                        <td>
                            <div class="selectbox">
                                <select name="AppId" id="AppId">
									
                                </select>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>经营模式：
                            </p>
                        </th>
                        <td>
                            <div class="selectbox">
                                <select name="FKWay" id="FKWay">

                                    <option value="1">仅零售</option>
                                    <option value="2">仅批发</option>
                                    <option value="3" selected>混合模式</option>
                                </select>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>菜单名称：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <input type="hidden" id="Id" name="Id" value="" />
                                <input type="text" id="MenuName" name="MenuName" validate="isnull" value="" maxlength="100" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                菜单样式：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <input type="text" id="CssClass" name="CssClass" value="" maxlength="100" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                菜单连接：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <input type="text" id="Link" name="Link" value="" maxlength="100" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>打开方式：
                            </p>
                        </th>
                        <td>
                            <div class="selectbox">
                                <select name="Target" id="Target">

                                    <option value="_self">当前页面</option>
                                    <option value="_blank">新页面</option>
                                 
                                </select>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                所属父级：
                            </p>
                        </th>
                        <td>
                            <div class="string">
                                <var id="ParentName"/>

                            </div>
                            <input type="hidden" Id="RoleId" value="0" />
                            <input type="hidden" Id="ParentId" value="0" />
                            <input type="hidden" Id="Layer" value="1" />
                        </td>
                    </tr>

                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>显示顺序：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <input id="Reorder" name="Reorder" type="text" value="0" error="输入格式不正确！" validate="isnull|intege3" />
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</script>


<script type="text/template" id="MoveFormTemplate">
    <div class="custom-table" id="MoveForm">
        <div class="form">
            <table border="0" cellpadding="0" cellspacing="0">
                <colgroup>
                    <col style="width: 150px;" />
                    <col style="width:auto;" />
                </colgroup>

                <tbody>
                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>菜单名称：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <input type="hidden" Id="Id" value="0" />
                                <input type="hidden" id="RealMenuId" />
                                <input type="hidden" Id="RoleId" value="0" />
                                <input type="hidden" Id="ContainSelf" value="0" />
                                <input type="text" id="MenuName" name="MenuName" validate="isnull" value="" maxlength="100" />
                            </div>
                        </td>
                    </tr>


                    <tr>
                        <th>
                            <p class="name">
                                移动到父级：
                            </p>
                        </th>
                        <td>
                            <div class="selectbox">
                                <select name="ParentId" id="ParentId">
                                   
                                </select>
                            </div>

                        </td>
                    </tr>


                </tbody>
            </table>
        </div>
    </div>
</script>
<script type="text/x-jquery-tmpl" id="RoleTemplate">
	<li label-btn="group1|click|key${roleId}" onclick="menu.loadMenu(${roleId},this);">${name}
	</li> 
</script>
<script language="javascript" type="text/javascript">
	$(function(){
		menu.loadRole();
		menu.loadMenu(0,$("#GroupList li:first"));
		app.loadApplication();
	});
</script>